# Estructura de Base de Datos Access

Archivo generado automáticamente para análisis por Claude Code

---

## Información General

| Propiedad | Valor |
|-----------|-------|
| Nombre del archivo | canela_true.mdb |
| Ruta | F:\Documentos\VB THINGS\Canela |
| Fecha de exportación | 19/12/2025 18:15:25 |
| Versión de Access | 16.0 |

## Tablas

### 1. arqueo

**Registros aproximados:** 41241

#### Campos

| # | Campo | Tipo | Tamaño | Requerido | Valor Predeterminado |
|---|-------|------|--------|-----------|---------------------|
| 1 | idventa | Entero largo | 4 | No | 0 |
| 2 | fecha | Fecha/Hora | 8 | No | Date() |
| 3 | caja | Moneda | 8 | No | 0 |
| 4 | tarjeta | Moneda | 8 | No | 0 |
| 5 | movimiento | Sí/No | 1 | No | Yes |
| 6 | concepto | Memo | 0 | No |  |

#### Índices

| Índice | Campos | Primario | Único |
|--------|--------|----------|-------|
| idventa | idventa | No | No |

---

### 2. articulodummy

**Registros aproximados:** 0

#### Campos

| # | Campo | Tipo | Tamaño | Requerido | Valor Predeterminado |
|---|-------|------|--------|-----------|---------------------|
| 1 | idarticulo | Doble | 8 | No |  |
| 2 | codigo | Texto | 50 | No |  |
| 3 | tipo | Texto | 50 | No |  |
| 4 | preciocompra | Moneda | 8 | No |  |
| 5 | precioventa | Moneda | 8 | No |  |
| 6 | descuento | Moneda | 8 | No |  |
| 7 | color | Texto | 50 | No |  |
| 8 | talla | Texto | 50 | No |  |
| 9 | extra | Texto | 50 | No |  |
| 10 | vendido | Sí/No | 1 | No |  |
| 11 | apartado | Sí/No | 1 | No |  |
| 12 | acuenta | Moneda | 8 | No |  |
| 13 | idcliente | Entero largo | 4 | No |  |
| 14 | devuelto | Sí/No | 1 | No |  |
| 15 | fechacompra | Fecha/Hora | 8 | No |  |
| 16 | fechaapartado | Fecha/Hora | 8 | No |  |
| 17 | fechaventa | Fecha/Hora | 8 | No |  |
| 18 | ID1 | Entero largo | 4 | No |  |

#### Índices

| Índice | Campos | Primario | Único |
|--------|--------|----------|-------|
| idarticulo | idarticulo | No | No |
| idcliente | idcliente | No | No |
| PrimaryKey | ID1 | No | No |

---

### 3. articulos

**Registros aproximados:** 54036

#### Campos

| # | Campo | Tipo | Tamaño | Requerido | Valor Predeterminado |
|---|-------|------|--------|-----------|---------------------|
| 1 | idart | Entero largo | 4 | No |  |
| 2 | idarticulo | Doble | 8 | No |  |
| 3 | codigo | Texto | 50 | No |  |
| 4 | tipo | Texto | 50 | No |  |
| 5 | preciocompra | Moneda | 8 | No |  |
| 6 | precioventa | Moneda | 8 | No |  |
| 7 | preciorebaja | Moneda | 8 | No |  |
| 8 | descuento | Moneda | 8 | No |  |
| 9 | color | Texto | 50 | No |  |
| 10 | talla | Texto | 50 | No |  |
| 11 | extra | Texto | 50 | No |  |
| 12 | vendido | Sí/No | 1 | No |  |
| 13 | apartado | Sí/No | 1 | No |  |
| 14 | inventario | Sí/No | 1 | No |  |
| 15 | acuenta | Moneda | 8 | No |  |
| 16 | idcliente | Entero largo | 4 | No |  |
| 17 | devuelto | Sí/No | 1 | No |  |
| 18 | fechacompra | Fecha/Hora | 8 | No | Date() |
| 19 | fechaapartado | Fecha/Hora | 8 | No |  |
| 20 | fechaventa | Fecha/Hora | 8 | No |  |
| 21 | ID1 | Entero largo | 4 | No |  |
| 22 | deposito | Sí/No | 1 | No |  |
| 23 | cantidad | Entero | 2 | No |  |
| 24 | foto | Texto | 255 | No |  |
| 25 | fotoweb | Texto | 255 | No |  |
| 26 | siniva | Moneda | 8 | No |  |
| 27 | iva | Entero | 2 | No |  |

#### Índices

| Índice | Campos | Primario | Único |
|--------|--------|----------|-------|
| idart | idart | No | No |
| idarticulo | idarticulo | No | No |
| idcliente | idcliente | No | No |
| PrimaryKey | ID1 | No | No |

---

### 4. articulos invierno 2003

**Registros aproximados:** 335

#### Campos

| # | Campo | Tipo | Tamaño | Requerido | Valor Predeterminado |
|---|-------|------|--------|-----------|---------------------|
| 1 | idarticulo | Entero largo | 4 | No |  |
| 2 | codigo | Texto | 50 | No |  |
| 3 | tipo | Texto | 50 | No |  |
| 4 | preciocompra | Texto | 50 | No |  |
| 5 | precioventa | Texto | 50 | No |  |
| 6 | descuento | Texto | 50 | No |  |
| 7 | color | Texto | 50 | No |  |
| 8 | talla | Texto | 50 | No |  |
| 9 | extra | Texto | 50 | No |  |
| 10 | vendido | Sí/No | 1 | No |  |
| 11 | apartado | Sí/No | 1 | No |  |
| 12 | acuenta | Texto | 50 | No |  |
| 13 | devuelto | Sí/No | 1 | No |  |
| 14 | fechacompra | Fecha/Hora | 8 | No |  |
| 15 | fechaapartado | Fecha/Hora | 8 | No |  |
| 16 | fechaventa | Fecha/Hora | 8 | No |  |
| 17 | ID1 | Entero largo | 4 | No |  |

#### Índices

| Índice | Campos | Primario | Único |
|--------|--------|----------|-------|
| idarticulo | idarticulo | No | No |
| PrimaryKey | ID1 | No | No |

---

### 5. clientemovil

**Registros aproximados:** 70

#### Campos

| # | Campo | Tipo | Tamaño | Requerido | Valor Predeterminado |
|---|-------|------|--------|-----------|---------------------|
| 1 | idcliente | Entero largo | 4 | No |  |
| 2 | nombre | Texto | 50 | No |  |
| 3 | apellidos | Texto | 50 | No |  |
| 4 | telefono | Entero largo | 4 | No |  |
| 5 | direccion | Texto | 50 | No |  |
| 6 | localidad | Texto | 20 | No |  |
| 7 | fechanac | Fecha/Hora | 8 | No |  |
| 8 | compras | Entero largo | 4 | No |  |
| 9 | avisar | Sí/No | 1 | No |  |

---

### 6. clientes

**Registros aproximados:** 1075

#### Campos

| # | Campo | Tipo | Tamaño | Requerido | Valor Predeterminado |
|---|-------|------|--------|-----------|---------------------|
| 1 | idcliente | Entero largo | 4 | No |  |
| 2 | nombre | Texto | 50 | No |  |
| 3 | apellidos | Texto | 50 | No |  |
| 4 | telefono | Entero largo | 4 | No |  |
| 5 | direccion | Texto | 50 | No |  |
| 6 | localidad | Texto | 20 | No |  |
| 7 | fechanac | Fecha/Hora | 8 | No |  |
| 8 | compras | Entero largo | 4 | No |  |
| 9 | avisar | Sí/No | 1 | No | True |

#### Índices

| Índice | Campos | Primario | Único |
|--------|--------|----------|-------|
| id | idcliente | No | No |
| PrimaryKey | idcliente | Sí | Sí |

---

### 7. detalleventa

**Registros aproximados:** 51791

#### Campos

| # | Campo | Tipo | Tamaño | Requerido | Valor Predeterminado |
|---|-------|------|--------|-----------|---------------------|
| 1 | idart | Entero largo | 4 | No | 0 |
| 2 | idcliente | Entero largo | 4 | No | 0 |
| 3 | idventa | Entero largo | 4 | Sí | 0 |
| 4 | preciofinal | Moneda | 8 | No | 0 |
| 5 | descuento | Entero largo | 4 | No | 0 |

#### Índices

| Índice | Campos | Primario | Único |
|--------|--------|----------|-------|
| idart | idart | No | No |
| idcliente | idcliente | No | No |
| idfactura | idventa | No | No |
| ventadetalleventa | idventa | No | No |

---

### 8. extras

**Registros aproximados:** 12

#### Campos

| # | Campo | Tipo | Tamaño | Requerido | Valor Predeterminado |
|---|-------|------|--------|-----------|---------------------|
| 1 | extras | Texto | 50 | No |  |

---

### 9. Facturas

**Registros aproximados:** 232

#### Campos

| # | Campo | Tipo | Tamaño | Requerido | Valor Predeterminado |
|---|-------|------|--------|-----------|---------------------|
| 1 | idfactura | Entero largo | 4 | No |  |
| 2 | identif | Texto | 50 | No |  |
| 3 | proveedor | Texto | 50 | No |  |
| 4 | fecha | Fecha/Hora | 8 | No |  |
| 5 | Factura | Sí/No | 1 | No |  |
| 6 | total | Moneda | 8 | No | 0 |
| 7 | pagado | Moneda | 8 | No | 0 |

#### Índices

| Índice | Campos | Primario | Único |
|--------|--------|----------|-------|
| identif | identif | No | No |
| idfactura | idfactura | No | No |
| PrimaryKey | idfactura | Sí | Sí |

---

### 10. inventario

**Registros aproximados:** 612

#### Campos

| # | Campo | Tipo | Tamaño | Requerido | Valor Predeterminado |
|---|-------|------|--------|-----------|---------------------|
| 1 | id | Entero largo | 4 | No | 0 |
| 2 | com | Texto | 50 | No |  |

#### Índices

| Índice | Campos | Primario | Único |
|--------|--------|----------|-------|
| id | id | No | Sí |

---

### 11. pago

**Registros aproximados:** 6

#### Campos

| # | Campo | Tipo | Tamaño | Requerido | Valor Predeterminado |
|---|-------|------|--------|-----------|---------------------|
| 1 | idpago | Entero largo | 4 | No |  |
| 2 | formapago | Texto | 50 | No |  |
| 3 | descuento | Entero largo | 4 | No | 0 |

#### Índices

| Índice | Campos | Primario | Único |
|--------|--------|----------|-------|
| idpago | idpago | No | No |
| PrimaryKey | idpago | Sí | Sí |

---

### 12. prestamo

**Registros aproximados:** 0

#### Campos

| # | Campo | Tipo | Tamaño | Requerido | Valor Predeterminado |
|---|-------|------|--------|-----------|---------------------|
| 1 | idcliente | Entero largo | 4 | No | 0 |
| 2 | idart | Entero largo | 4 | No | 0 |
| 3 | fecha | Fecha/Hora | 8 | No |  |
| 4 | comentario | Memo | 0 | No |  |

#### Índices

| Índice | Campos | Primario | Único |
|--------|--------|----------|-------|
| idarticulo | idart | No | No |
| idcliente | idcliente | No | No |

---

### 13. Proveedor

**Registros aproximados:** 40

#### Campos

| # | Campo | Tipo | Tamaño | Requerido | Valor Predeterminado |
|---|-------|------|--------|-----------|---------------------|
| 1 | codigo | Texto | 3 | No |  |
| 2 | proveedor | Texto | 50 | No |  |
| 3 | CIF/NIF | Texto | 9 | No |  |
| 4 | telefono | Texto | 50 | No |  |
| 5 | ID1 | Entero largo | 4 | No |  |

#### Índices

| Índice | Campos | Primario | Único |
|--------|--------|----------|-------|
| ID1 | ID1 | No | No |
| proveedorproveedor | proveedor | No | No |

---

### 14. tipo

**Registros aproximados:** 25

#### Campos

| # | Campo | Tipo | Tamaño | Requerido | Valor Predeterminado |
|---|-------|------|--------|-----------|---------------------|
| 1 | tipo | Texto | 50 | No |  |
| 2 | orden | Entero largo | 4 | No | 0 |

---

### 15. TotalXMes

**Registros aproximados:** 183

#### Campos

| # | Campo | Tipo | Tamaño | Requerido | Valor Predeterminado |
|---|-------|------|--------|-----------|---------------------|
| 1 | mes | Texto | 255 | No |  |
| 2 | año | Texto | 255 | No |  |
| 3 | efectivo | Moneda | 8 | No |  |
| 4 | tarjeta | Moneda | 8 | No |  |
| 5 | numarqueos | Entero | 2 | No |  |

---

### 16. ultimoid

**Registros aproximados:** 1

#### Campos

| # | Campo | Tipo | Tamaño | Requerido | Valor Predeterminado |
|---|-------|------|--------|-----------|---------------------|
| 1 | idarticulos | Entero largo | 4 | No |  |
| 2 | idclientes | Entero largo | 4 | No |  |
| 3 | idproveedores | Entero largo | 4 | No |  |

#### Índices

| Índice | Campos | Primario | Único |
|--------|--------|----------|-------|
| idarticulos | idarticulos | No | No |
| idclientes | idclientes | No | No |
| idproveedores | idproveedores | No | No |

---

### 17. venta

**Registros aproximados:** 39344

#### Campos

| # | Campo | Tipo | Tamaño | Requerido | Valor Predeterminado |
|---|-------|------|--------|-----------|---------------------|
| 1 | idventa | Entero largo | 4 | No |  |
| 2 | idcliente | Entero largo | 4 | No | 0 |
| 3 | fecha | Fecha/Hora | 8 | No | Now() |
| 4 | tarjeta | Moneda | 8 | No | 0 |
| 5 | pago | Texto | 50 | No |  |
| 6 | pagado | Sí/No | 1 | No |  |
| 7 | acuenta | Moneda | 8 | No | 0 |
| 8 | descuento | Moneda | 8 | No | 0 |
| 9 | total | Moneda | 8 | No | 0 |

#### Índices

| Índice | Campos | Primario | Único |
|--------|--------|----------|-------|
| clientesventa | idcliente | No | No |
| idusuario | idcliente | No | No |
| idventa1 | idventa | No | No |
| PrimaryKey | idventa | Sí | Sí |

---

## Relaciones

| Nombre | Tabla Principal | Tabla Relacionada | Campo Principal | Campo Foráneo | Integridad |
|--------|-----------------|-------------------|-----------------|---------------|------------|
| clientesventa | clientes | venta | idcliente | idcliente | Actualizar cascada |
| MSysAccessStorageSTGREL | MSysAccessStorage | MSysAccessStorage | Id | ParentId | Eliminar cascada |
| ProveedorFacturas | Proveedor | Facturas | codigo | proveedor | Ninguna |
| ventadetalleventa | venta | detalleventa | idventa | idventa | Actualizar cascada, Eliminar cascada |

## Consultas

### 1. alaventa

**Tipo:** Selección

```sql
SELECT articulos.idart, articulos.idarticulo, articulos.codigo, articulos.tipo, articulos.preciocompra, articulos.precioventa, articulos.descuento, articulos.color, articulos.talla, articulos.extra, articulos.vendido, articulos.apartado, articulos.acuenta, articulos.idcliente, articulos.devuelto, articulos.fechacompra, articulos.fechaapartado, articulos.fechaventa, articulos.ID1
FROM articulos
WHERE (((articulos.vendido)=No) AND ((articulos.devuelto)=No));

```

### 2. articulos Consulta

**Tipo:** Selección

```sql
SELECT articulos.idart, articulos.codigo, articulos.tipo, articulos.preciocompra, articulos.precioventa, articulos.vendido, articulos.extra
FROM articulos
WHERE (((articulos.idart)>8150))
ORDER BY articulos.idart;

```

### 3. artidevueltos

**Tipo:** Selección

```sql
SELECT articulos.idart, articulos.idarticulo, articulos.codigo, articulos.tipo, articulos.preciocompra, articulos.precioventa, articulos.descuento, articulos.color, articulos.talla, articulos.extra, articulos.vendido, articulos.apartado, articulos.acuenta, articulos.idcliente, articulos.devuelto, articulos.fechacompra, articulos.fechaapartado, articulos.fechaventa, articulos.ID1
FROM articulos
WHERE (((articulos.devuelto)=Yes));

```

### 4. birthday

**Tipo:** Selección

```sql
SELECT clientes.idcliente, clientes.nombre, clientes.apellidos, clientes.telefono, clientes.direccion, clientes.localidad, clientes.fechanac, clientes.compras
FROM clientes
WHERE (((clientes.telefono) Like "6*"));

```

### 5. Buscar duplicados por clientes

**Tipo:** Selección

```sql
SELECT clientes.telefono, clientes.idcliente, clientes.nombre, clientes.apellidos, clientes.direccion, clientes.localidad, clientes.fechanac, clientes.compras, clientes.avisar
FROM clientes
WHERE (((clientes.telefono) In (SELECT [telefono] FROM [clientes] As Tmp GROUP BY [telefono] HAVING Count(*)>1 )))
ORDER BY clientes.telefono;

```

### 6. clientes con movil

**Tipo:** Creación de tabla

```sql
SELECT clientes.idcliente, clientes.nombre, clientes.apellidos, clientes.telefono, clientes.direccion, clientes.localidad, clientes.fechanac, clientes.compras, clientes.avisar INTO clientemovil
FROM clientes
WHERE (((clientes.telefono) Like "6*") AND ((clientes.avisar)=Yes));

```

### 7. Facturas Proveedores

**Tipo:** Selección

```sql
SELECT Facturas.identif, proveedor.proveedor AS proveedor_proveedor, proveedor.[CIF/NIF], Facturas.fecha, Facturas.Factura, Facturas.total
FROM proveedor INNER JOIN Facturas ON proveedor.codigo = Facturas.proveedor
WHERE (((Facturas.fecha)>#10/1/2005#))
ORDER BY Facturas.fecha;

```

### 8. introducir articulos

**Tipo:** Selección

```sql
SELECT articulos.idart, articulos.codigo, articulos.tipo, articulos.preciocompra, articulos.precioventa, articulos.extra, articulos.talla
FROM articulos;

```

### 9. todos los Articulos

**Tipo:** Selección

```sql
SELECT articulos.idarticulo, articulos.codigo, articulos.tipo, articulos.preciocompra, articulos.precioventa, articulos.descuento, articulos.color, articulos.talla, articulos.extra, articulos.vendido, articulos.apartado, articulos.acuenta, articulos.idcliente, articulos.devuelto, articulos.fechacompra, articulos.fechaapartado, articulos.fechaventa, articulos.ID1
FROM articulos
WHERE (((articulos.fechaventa)>#3/4/2003#));

```

## Formularios

### 1. articulos

**Origen de registro:** articulos

**Controles principales:** idarticulo (TextBox), codigo (TextBox), tipo (TextBox), preciocompra (TextBox), precioventa (TextBox), descuento (TextBox), color (TextBox), talla (TextBox), extra (TextBox), ID1 (TextBox)

## Módulos de Código

| # | Nombre | Tipo |
|---|--------|------|
| - | *No hay módulos* | - |

**Nota:** Los formularios pueden contener código adicional en sus módulos de clase.

